<!doctype html>
<html>
  <head>
    <title>Cyber Trackr API Reference</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
    </style>
  </head>
  <body>
    <div id="app"></div>
    <script src="https://cdn.jsdelivr.net/npm/@scalar/api-reference"></script>
    <script>
      Scalar.createApiReference('#app', {
        spec: {
          content: "openapi: 3.1.1\ninfo:\n  title: Cyber Trackr API\n  description: |\n    Complete OpenAPI 3.1.1 specification for cyber.trackr.live API.\n    This API provides access to DISA STIGs, SRGs, RMF controls, CCIs, and SCAP data.\n    \n    ## DISA Cybersecurity Ecosystem Hierarchy\n    \n    ```\n    NIST RMF Controls (high-level policy framework)\n        ↓ (decomposed into atomic, testable statements)\n    CCIs (Control Correlation Identifiers - bridge policy to implementation)\n        ↓ (grouped by technology class into generic requirements)  \n    SRGs (Security Requirements Guides - technology class \"what\" to do)\n        ↓ (implemented as vendor-specific \"how\" to do it)\n    STIGs (Security Technical Implementation Guides - vendor/product specific)\n        ↓ (automated versions for scanning tools)\n    SCAP (Security Content Automation Protocol documents)\n    ```\n    \n    ## Critical Relationships\n    \n    - **RMF Controls** contain assessment procedures that reference **CCIs**\n    - **CCIs** map back to **RMF Controls** and forward to **STIG/SRG requirements**\n    - **SRGs** define generic technology requirements that **STIGs** implement specifically\n    - **V-IDs** can appear in both SRG and corresponding STIG (same requirement, different specificity)\n    - **SV-IDs** are XCCDF rule identifiers with revision tracking across document releases\n    \n  version: 1.0.0\n  contact:\n    name: Community OpenAPI Documentation\n    url: https://github.com/mitre/inspec-juniper/tree/main/tools/cyber-trackr-api\n  license:\n    name: Apache-2.0\n    url: https://www.apache.org/licenses/LICENSE-2.0\n\nservers:\n  - url: https://cyber.trackr.live/api\n    description: Production server (default)\n  - url: https://{subdomain}.trackr.live/api\n    description: Configurable server endpoint\n    variables:\n      subdomain:\n        default: cyber\n        description: The subdomain for the trackr.live API\n        enum:\n          - cyber\n          - test\n          - staging\n\nx-code-samples:\n  - lang: Ruby\n    label: \"Fetch complete STIG with all controls\"\n    source: |\n      # First get the document summary\n      doc = client.get_document('Juniper_SRX_Services_Gateway_ALG', '3', '3')\n      \n      # Then fetch detailed data for each requirement\n      complete_requirements = []\n      doc.requirements.each do |req|\n        detailed = client.get_requirement('Juniper_SRX_Services_Gateway_ALG', '3', '3', req.id)\n        complete_requirements << detailed\n        sleep 0.1 # Be respectful to the API\n      end\n  \n  - lang: Ruby\n    label: \"Filter STIGs from mixed list\"\n    source: |\n      # The listAllDocuments endpoint returns both STIGs and SRGs\n      all_docs = client.list_all_documents\n      \n      # Filter to get only STIGs\n      stigs = all_docs.reject { |name, versions| \n        name.include?('Security_Requirements_Guide') || name.include?('(SRG)')\n      }\n      \n      # Filter to get only SRGs\n      srgs = all_docs.select { |name, versions|\n        name.include?('Security_Requirements_Guide') || name.include?('(SRG)')\n      }\n\ntags:\n  - name: API Documentation\n    description: Self-documenting API root endpoint\n  - name: Documents\n    description: Security Technical Implementation Guides (STIGs) and Security Requirements Guides (SRGs)\n    x-display-name: STIG/SRG Documents\n  - name: RMF Controls\n    description: Risk Management Framework controls (NIST 800-53 rev 4 & 5)\n  - name: CCI\n    description: Control Correlation Identifiers (bridge RMF to implementation)\n  - name: SCAP\n    description: Security Content Automation Protocol documents\n\npaths:\n  /:\n    get:\n      operationId: getApiDocumentation\n      summary: Get API documentation\n      description: Returns self-documenting schema showing all available endpoints\n      tags:\n        - API Documentation\n      responses:\n        '200':\n          description: API endpoint documentation\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ApiDocumentation'\n\n  /stig:\n    get:\n      operationId: listAllDocuments\n      summary: List all STIGs and SRGs\n      description: |\n        Returns complete list of Security Technical Implementation Guides (STIGs) and \n        Security Requirements Guides (SRGs). **Note**: These are mixed in one endpoint.\n      tags:\n        - Documents\n      x-returns-mixed-content: true\n      x-note: \"Returns both STIGs and SRGs mixed together. Use name patterns to distinguish\"\n      x-rate-limit: \"No documented limit, but please be respectful\"\n      responses:\n        '200':\n          description: Complete list of STIGs and SRGs grouped by document name\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/DocumentList'\n          links:\n            GetDocument:\n              operationId: getDocument\n              description: Get full document details for any STIG/SRG from the list\n              parameters:\n                title: '$response.body#/{documentName}/0/name'\n                version: '$response.body#/{documentName}/0/version'\n                release: '$response.body#/{documentName}/0/release'\n\n  /stig/{title}/{version}/{release}:\n    get:\n      operationId: getDocument\n      summary: Get STIG or SRG document details\n      description: Returns complete document with all requirements\n      tags:\n        - Documents\n      x-note: \"Returns document with requirement summaries only. Use getRequirement for full control details\"\n      x-requirements-structure: \"Requirements are returned as an object with V-IDs as keys, not an array\"\n      parameters:\n        - name: title\n          in: path\n          required: true\n          description: Document title exactly as it appears in the list endpoint\n          schema:\n            type: string\n            minLength: 1\n            maxLength: 200\n          example: \"Juniper_SRX_Services_Gateway_ALG\"\n        - name: version\n          in: path\n          required: true\n          description: Major version number of the document\n          schema:\n            type: string\n            pattern: '^\\d+$'\n          example: \"3\"\n        - name: release\n          in: path\n          required: true\n          description: Release number within the version\n          schema:\n            type: string\n            pattern: '^\\d+(\\.\\d+)?$'\n          example: \"3\"\n      responses:\n        '200':\n          description: Complete document details with all requirements\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/DocumentDetail'\n          links:\n            GetRequirement:\n              operationId: getRequirement\n              description: Get full details for any requirement in this document\n              parameters:\n                title: '$request.path.title'\n                version: '$request.path.version'\n                release: '$request.path.release'\n                vuln: '$response.body#/requirements/{index}/id'\n\n  /stig/{title}/{version}/{release}/{vuln}:\n    get:\n      operationId: getRequirement\n      summary: Get individual STIG/SRG requirement details\n      description: Returns complete details for a specific requirement\n      tags:\n        - Documents\n      x-note: \"Returns full requirement details including assessment procedures and CCI mappings\"\n      x-slow-operation: true\n      parameters:\n        - name: title\n          in: path\n          required: true\n          description: Document title exactly as it appears in the list endpoint\n          schema:\n            type: string\n            minLength: 1\n            maxLength: 200\n          example: \"Juniper_SRX_Services_Gateway_ALG\"\n        - name: version\n          in: path\n          required: true\n          description: Major version number of the document\n          schema:\n            type: string\n            pattern: '^\\d+$'\n          example: \"3\"\n        - name: release\n          in: path\n          required: true\n          description: Release number within the version\n          schema:\n            type: string\n            pattern: '^\\d+(\\.\\d+)?$'\n          example: \"3\"\n        - name: vuln\n          in: path\n          required: true\n          description: Vulnerability/Requirement ID (V-XXXXXX format)\n          schema:\n            type: string\n            pattern: '^V-\\d{6}$'\n          example: \"V-214518\"\n      responses:\n        '200':\n          description: Complete requirement details\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/RequirementDetail'\n        '500':\n          description: Server error (usually invalid parameter format)\n          x-note: \"Returns 500 (not 404) for invalid V-ID format like 'V-INVALID'\"\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Error'\n\n  /rmf/4:\n    get:\n      operationId: listRmfControlsV4\n      summary: List RMF revision 4 controls\n      description: Returns all Risk Management Framework revision 4 controls with titles\n      tags:\n        - RMF Controls\n      responses:\n        '200':\n          description: Complete list of RMF rev 4 controls\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/RmfControlList'\n\n  /rmf/5:\n    get:\n      operationId: listRmfControlsV5\n      summary: List RMF revision 5 controls\n      description: Returns all Risk Management Framework revision 5 controls with titles\n      tags:\n        - RMF Controls\n      responses:\n        '200':\n          description: Complete list of RMF rev 5 controls\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/RmfControlList'\n\n  /rmf/4/{control}:\n    get:\n      operationId: getRmfControlV4\n      summary: Get RMF revision 4 control details\n      description: Returns complete RMF control details including CCI mappings\n      tags:\n        - RMF Controls\n      parameters:\n        - name: control\n          in: path\n          required: true\n          description: RMF control identifier (family-number format)\n          schema:\n            type: string\n            pattern: '^[A-Z]+-\\d+$'\n          example: \"AC-1\"\n      responses:\n        '200':\n          description: Complete RMF control details with CCI mappings\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/RmfControlDetail'\n\n  /rmf/5/{control}:\n    get:\n      operationId: getRmfControlV5\n      summary: Get RMF revision 5 control details\n      description: Returns complete RMF control details including CCI mappings\n      tags:\n        - RMF Controls\n      parameters:\n        - name: control\n          in: path\n          required: true\n          description: RMF control identifier (family-number format)\n          schema:\n            type: string\n            pattern: '^[A-Z]+-\\d+$'\n          example: \"AC-1\"\n      responses:\n        '200':\n          description: Complete RMF control details with CCI mappings\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/RmfControlDetail'\n\n  /scap:\n    get:\n      operationId: listScapDocuments\n      summary: List all SCAP documents\n      description: |\n        Returns list of Security Content Automation Protocol documents.\n        These are automated scanning versions of STIGs.\n      tags:\n        - SCAP\n      responses:\n        '200':\n          description: List of SCAP documents grouped by name\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/DocumentList'\n\n  /scap/{title}/{version}/{release}:\n    get:\n      operationId: getScapDocument\n      summary: Get SCAP document details\n      description: Returns complete SCAP document with all requirements (same structure as STIG)\n      tags:\n        - SCAP\n      parameters:\n        - name: title\n          in: path\n          required: true\n          description: Document title exactly as it appears in the list endpoint\n          schema:\n            type: string\n            minLength: 1\n            maxLength: 200\n          example: \"U_MS_Windows_10_V3R2_STIG_SCAP_1-2_Benchmark\"\n        - name: version\n          in: path\n          required: true\n          description: Major version number of the document\n          schema:\n            type: string\n            pattern: '^\\d+$'\n          example: \"3\"\n        - name: release\n          in: path\n          required: true\n          description: Release number within the version\n          schema:\n            type: string\n            pattern: '^\\d+(\\.\\d+)?$'\n          example: \"2\"\n      responses:\n        '200':\n          description: Complete SCAP document details\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/DocumentDetail'\n\n  /scap/{title}/{version}/{release}/{vuln}:\n    get:\n      operationId: getScapRequirement\n      summary: Get individual SCAP requirement details\n      description: Returns complete details for specific SCAP requirement (same structure as STIG requirement)\n      tags:\n        - SCAP\n      parameters:\n        - name: title\n          in: path\n          required: true\n          description: Document title exactly as it appears in the list endpoint\n          schema:\n            type: string\n            minLength: 1\n            maxLength: 200\n          example: \"U_MS_Windows_10_V3R2_STIG_SCAP_1-2_Benchmark\"\n        - name: version\n          in: path\n          required: true\n          description: Major version number of the document\n          schema:\n            type: string\n            pattern: '^\\d+$'\n          example: \"3\"\n        - name: release\n          in: path\n          required: true\n          description: Release number within the version\n          schema:\n            type: string\n            pattern: '^\\d+(\\.\\d+)?$'\n          example: \"2\"\n        - name: vuln\n          in: path\n          required: true\n          description: Vulnerability/Requirement ID (V-XXXXXX format)\n          schema:\n            type: string\n            pattern: '^V-\\d{6}$'\n          example: \"V-220697\"\n      responses:\n        '200':\n          description: Complete SCAP requirement details\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/RequirementDetail'\n        '500':\n          description: Server error (usually invalid parameter format)\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Error'\n\n  /cci:\n    get:\n      operationId: listCcis\n      summary: List all Control Correlation Identifiers\n      description: Returns complete list of CCIs with their definitions\n      tags:\n        - CCI\n      responses:\n        '200':\n          description: Complete list of CCIs with definitions\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/CciList'\n\n  /cci/{item}:\n    get:\n      operationId: getCciDetails\n      summary: Get CCI details with RMF mapping\n      description: Returns complete CCI details including RMF control mapping\n      tags:\n        - CCI\n      parameters:\n        - name: item\n          in: path\n          required: true\n          description: Control Correlation Identifier (CCI-XXXXXX format)\n          schema:\n            type: string\n            pattern: '^CCI-\\d{6}$'\n          example: \"CCI-000001\"\n      responses:\n        '200':\n          description: Complete CCI details with RMF control mapping\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/CciDetail'\n          links:\n            GetRmfControlV4:\n              operationId: getRmfControlV4\n              description: Get the mapped RMF revision 4 control\n              parameters:\n                control: '$response.body#/assessment_procedures/0/control_identifier'\n            GetRmfControlV5:\n              operationId: getRmfControlV5\n              description: Get the mapped RMF revision 5 control (if revision 5)\n              parameters:\n                control: '$response.body#/assessment_procedures/0/control_identifier'\n        '500':\n          description: Server error (usually invalid CCI format)\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Error'\n\nsecurity: []  # No authentication required for any endpoints\n\ncomponents:\n  securitySchemes: {}  # No security schemes - this is a public API\n  \n  schemas:\n    ApiDocumentation:\n      type: object\n      description: Self-documenting API schema from root endpoint\n      required:\n        - server_api_root\n      properties:\n        server_api_root:\n          type: string\n          format: uri\n          example: \"https://cyber.trackr.live/api\"\n      additionalProperties:\n        type: string\n        description: \"Endpoint path templates (e.g., '/stig/{title}/{version}/{release}')\"\n\n    DocumentList:\n      type: object\n      description: List of documents grouped by name with version information\n      additionalProperties:\n        type: array\n        items:\n          $ref: '#/components/schemas/DocumentVersion'\n\n    DocumentVersion:\n      type: object\n      description: Version information for a specific document release\n      required:\n        - version\n        - release\n        - link\n      properties:\n        date:\n          type: string\n          description: \"File creation/build date in YYYY-MM-DD format (may be empty)\"\n          pattern: '^(\\d{4}-\\d{2}-\\d{2}|)$'\n          example: \"2024-12-19\"\n        released:\n          type: string\n          description: \"Publication/release date in human-readable format (with leading space)\"\n          pattern: '^ \\d{1,2} \\w+ \\d{4}$'\n          example: \" 30 Jan 2025\"\n        version:\n          type: string\n          pattern: '^[Vv]?\\d+$'\n          example: \"3\"\n        release:\n          type: string\n          pattern: '^\\d+(\\.\\d+)?$'\n          example: \"3\"\n        link:\n          type: string\n          pattern: '^/(stig|scap)/.+$'\n          example: \"/stig/Juniper_SRX_Services_Gateway_ALG/3/3\"\n\n    DocumentDetail:\n      type: object\n      description: Complete document details with all requirements\n      required:\n        - id\n        - title\n        - description\n        - status\n        - published\n        - requirements\n      properties:\n        id:\n          type: string\n          minLength: 1\n          example: \"Juniper_SRX_SG_ALG_STIG\"\n        title:\n          type: string\n          minLength: 1\n          example: \"Juniper SRX Services Gateway ALG Security Technical Implementation Guide\"\n        description:\n          type: string\n          minLength: 1\n        status:\n          type: string\n          enum: [accepted, draft, deprecated]\n          example: \"accepted\"\n        published:\n          type: string\n          description: \"Document publication date in YYYY-MM-DD format\"\n          pattern: '^\\d{4}-\\d{2}-\\d{2}$'\n          example: \"2024-12-19\"\n        requirements:\n          type: object\n          description: \"Requirements mapped by V-ID (e.g., V-214518 as key)\"\n          additionalProperties:\n            $ref: '#/components/schemas/RequirementSummary'\n\n    RequirementSummary:\n      type: object\n      description: Summary information for a requirement within a document\n      required:\n        - title\n        - rule\n        - severity\n        - link\n      properties:\n        title:\n          type: string\n          minLength: 1\n        rule:\n          type: string\n          pattern: '^SV-\\d+r\\d+_rule$'\n          example: \"SV-214518r997541_rule\"\n        severity:\n          type: string\n          enum: [high, medium, low]\n        link:\n          type: string\n\n    RequirementDetail:\n      type: object\n      description: Complete requirement details with implementation guidance\n      required:\n        - id\n        - rule\n        - severity\n        - requirement-title\n        - check-text\n        - fix-text\n      properties:\n        id:\n          type: string\n          pattern: '^V-\\d{6}$'\n          example: \"V-214518\"\n        rule:\n          type: string\n          pattern: '^SV-\\d+r\\d+_rule$'\n          example: \"SV-214518r997541_rule\"\n        severity:\n          type: string\n          enum: [high, medium, low]\n        requirement-title:\n          type: string\n          minLength: 1\n        requirement-description:\n          type: string\n          minLength: 1\n        mitigation-statement:\n          anyOf:\n            - type: string\n            - type: \"null\"\n        identifiers:\n          type: array\n          items:\n            type: string\n          example: [\"V-66003\", \"SV-80493\", \"CCI-000213\"]\n        check-text:\n          type: string\n          minLength: 1\n        fix-text:\n          type: string\n          minLength: 1\n        check-id:\n          type: string\n          description: \"Check procedure identifier\"\n        fix-id:\n          type: string\n          description: \"Fix procedure identifier\"\n        group:\n          type: string\n          description: \"Requirement group identifier\"\n        version:\n          type: string\n          description: \"Requirement version\"\n        stig:\n          type: string\n          description: \"Parent STIG identifier\"\n        stig-title:\n          type: string\n          description: \"Parent STIG title\"\n        stig-description:\n          type: string\n          description: \"Parent STIG description\"\n        stig-published:\n          type: string\n          description: \"Parent STIG publication date\"\n        stig-status:\n          type: string\n          description: \"Parent STIG status\"\n\n    RmfControlDetail:\n      type: object\n      description: Complete RMF control details with CCI mappings\n      required:\n        - number\n        - title\n        - family\n        - baseline\n        - statements\n        - assessment_procedures\n      properties:\n        number:\n          type: string\n          pattern: '^[A-Z]+-\\d+$'\n          example: \"AC-1\"\n        title:\n          type: string\n          minLength: 1\n          example: \"POLICY AND PROCEDURES\"\n        family:\n          type: string\n          minLength: 1\n          example: \"ACCESS CONTROL\"\n        baseline:\n          type: array\n          items:\n            type: string\n            enum: [LOW, MODERATE, HIGH, PRIVACY]\n          minItems: 1\n          example: [\"LOW\", \"MODERATE\", \"HIGH\", \"PRIVACY\"]\n        statements:\n          type: string\n          minLength: 1\n        assessment_procedures:\n          type: array\n          items:\n            $ref: '#/components/schemas/AssessmentProcedure'\n          minItems: 1\n\n    AssessmentProcedure:\n      type: object\n      description: Assessment procedure linking RMF control sub-parts to CCIs\n      required:\n        - assessment_procedures\n        - cci\n        - description\n      properties:\n        assessment_procedures:\n          type: string\n          pattern: '^[A-Z]+-\\d+\\.\\d+$'\n          example: \"AC-1.3\"\n        cci:\n          type: string\n          pattern: '^CCI-\\d{6}$'\n          example: \"CCI-000001\"\n        description:\n          type: string\n          minLength: 1\n\n    CciList:\n      type: object\n      description: Complete list of Control Correlation Identifiers with definitions\n      additionalProperties:\n        type: string\n        minLength: 1\n\n    CciDetail:\n      type: object\n      description: Complete CCI details with RMF control mapping\n      required:\n        - cci\n        - cci_definition\n        - rmf\n        - family\n        - name\n      properties:\n        cci:\n          type: string\n          pattern: '^CCI-\\d{6}$'\n          example: \"CCI-000001\"\n        cci_definition:\n          type: string\n          minLength: 1\n        rmf:\n          type: string\n          pattern: '^[A-Z]+-\\d+$'\n          example: \"AC-1\"\n        family:\n          type: string\n          minLength: 1\n          example: \"Access Control\"\n        name:\n          type: string\n          minLength: 1\n          example: \"Access Control Policy And Procedures\"\n\n    RmfControlList:\n      type: object\n      description: List of RMF controls with titles\n      required:\n        - controls\n      properties:\n        controls:\n          type: object\n          description: RMF controls mapped to titles\n          additionalProperties:\n            type: string\n            minLength: 1\n\n    Error:\n      type: object\n      description: Error response format\n      required:\n        - status\n        - title\n      properties:\n        type:\n          type: string\n          format: uri\n          description: Error type reference\n        title:\n          type: string\n          description: Error title\n          minLength: 1\n        status:\n          type: integer\n          description: HTTP status code\n          minimum: 400\n          maximum: 599\n        detail:\n          type: string\n          description: Error details"
        },
        proxyUrl: 'https://proxy.scalar.com',
        configuration: {
          layout: 'modern',
          theme: 'default',
          showSidebar: true,
          searchHotKey: 'k'
        },
        metaData: {
          title: 'Cyber Trackr API Documentation',
          description: 'Complete OpenAPI 3.1.1 specification for cyber.trackr.live API',
          ogDescription: 'Access to DISA STIGs, SRGs, RMF controls, CCIs, and SCAP data',
        }
      })
    </script>
  </body>
</html>