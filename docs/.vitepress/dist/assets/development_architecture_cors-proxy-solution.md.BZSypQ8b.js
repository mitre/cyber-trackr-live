import{_ as h,C as k,c,o as e,at as p,b as r,j as t,w as s,a,G as n,au as o}from"./chunks/framework.BV4VMCSO.js";const b=JSON.parse('{"title":"CORS Proxy Solution for Static Site Documentation","description":"","frontmatter":{},"headers":[],"relativePath":"development/architecture/cors-proxy-solution.md","filePath":"development/architecture/cors-proxy-solution.md"}'),d={name:"development/architecture/cors-proxy-solution.md"};function E(u,i,A,g,y,f){const l=k("Mermaid");return e(),c("div",null,[i[3]||(i[3]=p('<h1 id="cors-proxy-solution-for-static-site-documentation" tabindex="-1">CORS Proxy Solution for Static Site Documentation <a class="header-anchor" href="#cors-proxy-solution-for-static-site-documentation" aria-label="Permalink to &quot;CORS Proxy Solution for Static Site Documentation&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>Interactive OpenAPI documentation on static hosting platforms (like GitHub Pages) faces CORS limitations when trying to make API calls. Our solution uses a global fetch interceptor with Scalar&#39;s proven proxy methodology.</p><h2 id="the-cors-problem" tabindex="-1">The CORS Problem <a class="header-anchor" href="#the-cors-problem" aria-label="Permalink to &quot;The CORS Problem&quot;">​</a></h2>',4)),(e(),r(o,null,{default:s(()=>[n(l,{id:"mermaid-12",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20Browser%0A%20%20%20%20participant%20GH%20as%20GitHub%20Pages%0A%20%20%20%20participant%20API%20as%20cyber.trackr.live%0A%20%20%20%20%0A%20%20%20%20Browser-%3E%3EGH%3A%20Load%20VitePress%20docs%0A%20%20%20%20GH--%3E%3EBrowser%3A%20Static%20HTML%2FJS%0A%20%20%20%20Browser-%3E%3EAPI%3A%20Try%20API%20call%20(try-it-out)%0A%20%20%20%20API--%3E%3EBrowser%3A%20%E2%9D%8C%20CORS%20blocked%0A%20%20%20%20%0A%20%20%20%20Note%20over%20Browser%2CAPI%3A%20CORS%20policy%20blocks%20cross-origin%20requests%0A"})]),fallback:s(()=>i[0]||(i[0]=[a(" Loading... ")])),_:1})),i[4]||(i[4]=t("h2",{id:"our-solution-global-fetch-interceptor",tabindex:"-1"},[a("Our Solution: Global Fetch Interceptor "),t("a",{class:"header-anchor",href:"#our-solution-global-fetch-interceptor","aria-label":'Permalink to "Our Solution: Global Fetch Interceptor"'},"​")],-1)),(e(),r(o,null,{default:s(()=>[n(l,{id:"mermaid-16",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20Browser%0A%20%20%20%20participant%20GH%20as%20GitHub%20Pages%0A%20%20%20%20participant%20Interceptor%20as%20Fetch%20Interceptor%0A%20%20%20%20participant%20Proxy%20as%20proxy.scalar.com%0A%20%20%20%20participant%20API%20as%20cyber.trackr.live%0A%20%20%20%20%0A%20%20%20%20Browser-%3E%3EGH%3A%20Load%20VitePress%20docs%0A%20%20%20%20GH--%3E%3EBrowser%3A%20Static%20HTML%2FJS%20%2B%20Interceptor%0A%20%20%20%20%0A%20%20%20%20Note%20over%20Browser%2CInterceptor%3A%20setupProxyInterceptor%20replaces%20window.fetch%0A%20%20%20%20%0A%20%20%20%20Browser-%3E%3EInterceptor%3A%20fetch%20API%20call%0A%20%20%20%20Interceptor-%3E%3EInterceptor%3A%20shouldUseProxy%20%E2%86%92%20true%0A%20%20%20%20Interceptor-%3E%3EInterceptor%3A%20redirectToProxy%20%E2%86%92%20proxy%20URL%0A%20%20%20%20Interceptor-%3E%3EProxy%3A%20fetch%20with%20scalar_url%20param%0A%20%20%20%20Proxy-%3E%3EAPI%3A%20Forward%20request%0A%20%20%20%20API--%3E%3EProxy%3A%20API%20response%0A%20%20%20%20Proxy--%3E%3EInterceptor%3A%20%E2%9C%85%20Proxied%20response%0A%20%20%20%20Interceptor--%3E%3EBrowser%3A%20%E2%9C%85%20Success%0A"})]),fallback:s(()=>i[1]||(i[1]=[a(" Loading... ")])),_:1})),i[5]||(i[5]=t("h2",{id:"implementation-architecture",tabindex:"-1"},[a("Implementation Architecture "),t("a",{class:"header-anchor",href:"#implementation-architecture","aria-label":'Permalink to "Implementation Architecture"'},"​")],-1)),(e(),r(o,null,{default:s(()=>[n(l,{id:"mermaid-20",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20A%5BVitePress%20OpenAPI%5D%20--%3E%20B%5BGlobal%20Fetch%20Interceptor%5D%0A%20%20%20%20B%20--%3E%20C%7BIs%20External%20API%3F%7D%0A%20%20%20%20%0A%20%20%20%20C%20--%3E%7CNo%7C%20D%5BOriginal%20Fetch%20-%20Local%20assets%5D%0A%20%20%20%20C%20--%3E%7CYes%7C%20E%5BProxy%20Decision%20Logic%5D%0A%20%20%20%20%0A%20%20%20%20E%20--%3E%20F%5BshouldUseProxy%5D%0A%20%20%20%20F%20--%3E%20G%5BredirectToProxy%5D%0A%20%20%20%20G%20--%3E%20H%5BScalar%20Proxy%20Service%20-%20proxy.scalar.com%5D%0A%20%20%20%20%0A%20%20%20%20H%20--%3E%20I%5BExternal%20API%20-%20cyber.trackr.live%5D%0A%20%20%20%20I%20--%3E%20J%5BAPI%20Response%5D%0A%20%20%20%20J%20--%3E%20K%5BBack%20to%20Browser%5D%0A%20%20%20%20%0A%20%20%20%20D%20--%3E%20L%5BVitePress%20UI%5D%0A%20%20%20%20K%20--%3E%20L%0A%20%20%20%20%0A%20%20%20%20style%20A%20fill%3A%2328a745%2Cstroke%3A%231e7e34%2Cstroke-width%3A2px%2Ccolor%3A%23ffffff%0A%20%20%20%20style%20B%20fill%3A%23fd7e14%2Cstroke%3A%23e55100%2Cstroke-width%3A2px%2Ccolor%3A%23000000%0A%20%20%20%20style%20C%20fill%3A%23007bff%2Cstroke%3A%230056b3%2Cstroke-width%3A2px%2Ccolor%3A%23ffffff%0A%20%20%20%20style%20D%20fill%3A%2328a745%2Cstroke%3A%231e7e34%2Cstroke-width%3A2px%2Ccolor%3A%23ffffff%0A%20%20%20%20style%20E%20fill%3A%23fd7e14%2Cstroke%3A%23e55100%2Cstroke-width%3A2px%2Ccolor%3A%23000000%0A%20%20%20%20style%20F%20fill%3A%23fd7e14%2Cstroke%3A%23e55100%2Cstroke-width%3A2px%2Ccolor%3A%23000000%0A%20%20%20%20style%20G%20fill%3A%23fd7e14%2Cstroke%3A%23e55100%2Cstroke-width%3A2px%2Ccolor%3A%23000000%0A%20%20%20%20style%20H%20fill%3A%23dc3545%2Cstroke%3A%23bd2130%2Cstroke-width%3A2px%2Ccolor%3A%23ffffff%0A%20%20%20%20style%20I%20fill%3A%23dc3545%2Cstroke%3A%23bd2130%2Cstroke-width%3A2px%2Ccolor%3A%23ffffff%0A%20%20%20%20style%20J%20fill%3A%23fd7e14%2Cstroke%3A%23e55100%2Cstroke-width%3A2px%2Ccolor%3A%23000000%0A%20%20%20%20style%20K%20fill%3A%23fd7e14%2Cstroke%3A%23e55100%2Cstroke-width%3A2px%2Ccolor%3A%23000000%0A%20%20%20%20style%20L%20fill%3A%2328a745%2Cstroke%3A%231e7e34%2Cstroke-width%3A2px%2Ccolor%3A%23ffffff%0A"})]),fallback:s(()=>i[2]||(i[2]=[a(" Loading... ")])),_:1})),i[6]||(i[6]=p(`<h2 id="key-components" tabindex="-1">Key Components <a class="header-anchor" href="#key-components" aria-label="Permalink to &quot;Key Components&quot;">​</a></h2><h3 id="_1-proxy-detection-logic" tabindex="-1">1. Proxy Detection Logic <a class="header-anchor" href="#_1-proxy-detection-logic" aria-label="Permalink to &quot;1. Proxy Detection Logic&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> shouldUseProxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">proxyUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Don&#39;t proxy localhost/relative URLs</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isRelativePath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> isLocalUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Proxy external APIs through remote proxy service</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isLocalUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxyUrl) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isLocalUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_2-url-transformation" tabindex="-1">2. URL Transformation <a class="header-anchor" href="#_2-url-transformation" aria-label="Permalink to &quot;2. URL Transformation&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> redirectToProxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">proxyUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newUrl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxyUrl)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  newUrl.searchParams.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;scalar_url&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, url)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newUrl.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_3-global-fetch-replacement" tabindex="-1">3. Global Fetch Replacement <a class="header-anchor" href="#_3-global-fetch-replacement" aria-label="Permalink to &quot;3. Global Fetch Replacement&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> originalFetch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window.fetch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> input </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;string&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> input </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> input.url</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">shouldUseProxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxyUrl, url)) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetchWithProxyFallback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url, proxyUrl, originalFetch)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> originalFetch.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, input, init)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="benefits" tabindex="-1">Benefits <a class="header-anchor" href="#benefits" aria-label="Permalink to &quot;Benefits&quot;">​</a></h2><h3 id="✅-production-ready" tabindex="-1">✅ <strong>Production Ready</strong> <a class="header-anchor" href="#✅-production-ready" aria-label="Permalink to &quot;✅ **Production Ready**&quot;">​</a></h3><ul><li>Works on any static hosting platform</li><li>No server-side configuration required</li><li>Uses proven Scalar proxy infrastructure</li></ul><h3 id="✅-transparent-operation" tabindex="-1">✅ <strong>Transparent Operation</strong> <a class="header-anchor" href="#✅-transparent-operation" aria-label="Permalink to &quot;✅ **Transparent Operation**&quot;">​</a></h3><ul><li>VitePress OpenAPI sees original server URLs</li><li>No URL manipulation in documentation</li><li>Automatic proxy routing for external APIs</li></ul><h3 id="✅-development-friendly" tabindex="-1">✅ <strong>Development Friendly</strong> <a class="header-anchor" href="#✅-development-friendly" aria-label="Permalink to &quot;✅ **Development Friendly**&quot;">​</a></h3><ul><li>Same code works in development and production</li><li>Easy to enable/disable for debugging</li><li>Comprehensive logging for troubleshooting</li></ul><h3 id="✅-scalable-solution" tabindex="-1">✅ <strong>Scalable Solution</strong> <a class="header-anchor" href="#✅-scalable-solution" aria-label="Permalink to &quot;✅ **Scalable Solution**&quot;">​</a></h3><ul><li>Handles simple and complex API endpoints</li><li>Graceful fallback if proxy fails</li><li>No performance impact on local resources</li></ul><h2 id="real-world-example" tabindex="-1">Real-World Example <a class="header-anchor" href="#real-world-example" aria-label="Permalink to &quot;Real-World Example&quot;">​</a></h2><h3 id="original-api-call" tabindex="-1">Original API Call: <a class="header-anchor" href="#original-api-call" aria-label="Permalink to &quot;Original API Call:&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://cyber.trackr.live/api/stig/Juniper_SRX_Services_Gateway_ALG/3/3</span></span></code></pre></div><h3 id="intercepted-and-proxied" tabindex="-1">Intercepted and Proxied: <a class="header-anchor" href="#intercepted-and-proxied" aria-label="Permalink to &quot;Intercepted and Proxied:&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://proxy.scalar.com/?scalar_url=https%3A%2F%2Fcyber.trackr.live%2Fapi%2Fstig%2FJuniper_SRX_Services_Gateway_ALG%2F3%2F3</span></span></code></pre></div><h3 id="result" tabindex="-1">Result: <a class="header-anchor" href="#result" aria-label="Permalink to &quot;Result:&quot;">​</a></h3><ul><li>✅ API call succeeds</li><li>✅ Response data identical</li><li>✅ Try-it-out functionality works</li><li>✅ CORS completely handled</li></ul><h2 id="universal-pattern" tabindex="-1">Universal Pattern <a class="header-anchor" href="#universal-pattern" aria-label="Permalink to &quot;Universal Pattern&quot;">​</a></h2><p>This solution works for <strong>any OpenAPI project</strong> needing interactive documentation on static hosting:</p><ol><li><strong>Copy the proxy interceptor plugin</strong></li><li><strong>Configure for your API endpoints</strong></li><li><strong>Deploy to GitHub Pages/Netlify/etc.</strong></li><li><strong>Interactive docs work perfectly</strong></li></ol><p>The pattern eliminates the fundamental limitation of static site hosting for API documentation, making it possible to have full-featured interactive docs without server infrastructure.</p>`,27))])}const F=h(d,[["render",E]]);export{b as __pageData,F as default};
